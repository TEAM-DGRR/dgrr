// GameMatch.tsx

import "assets/scss/Match.scss";
import { useEffect, useState } from "react";
import { useNavigate } from "react-router-dom";
import { useGameContext } from "./GameContext";



// const USER1_NICKNAME = "나 이수연인데";
// const USER1_INTRO = "대표적인 양서류 중 하나. 고어로는 '머구리'라 했으며[2], 사투리로 '개구락지'라고도 한다.";
// const USER2_NICKNAME = "개구락지";
// const USER2_INTRO = "비개구리처럼 알에서 태어날 때 즈음에 이미 개구리인 종류도 존재한다.";

export const GameMatch = () => {
  const navigate = useNavigate();
  const [seconds, setSeconds] = useState(0);

  // Stomp
  const { stompClient, isStompConnected, gameConfig } = useGameContext();
  const { gameSessionId, openViduToken, startTime, myInfo, enemyInfo } = gameConfig;


  // const vsPersonProfile1 = enemyInfo.profileImage;
  const vsPersonProfile1 = "https://dgrr-bucket.s3.ap-northeast-2.amazonaws.com/71961d40-02d6-424b-888b-693c08ed3fa8.png";
  const USER1_NICKNAME = enemyInfo.nickname;
  const USER1_INTRO = enemyInfo.description;

  // const vsPersonProfile2 = myInfo.profileImage;
  const vsPersonProfile2 = "https://dgrr-bucket.s3.ap-northeast-2.amazonaws.com/71961d40-02d6-424b-888b-693c08ed3fa8.png";
  const USER2_NICKNAME = myInfo.nickname;
  const USER2_INTRO = myInfo.description;

  useEffect(() => {
    const interval = setInterval(() => {
      setSeconds(prev => prev + 1);
    }, 1000);
    console.log("GameMatch에서 찍히는 useGameContext : ", useGameContext);
    console.log("GameMatch에서 찍히는 isStompConnected : ", isStompConnected);

    if (seconds === 5) {
      navigate("/game/play");
    }

    // Cleanup on unmount
    return () => clearInterval(interval);

  }, [seconds, gameConfig, navigate]);

  return (
    <div className="MatchPage">
      {/* Adding the VersusImage in the center of MatchPage */}
      <div className="VersusImage"></div>

      <div className="MatchedPerson1">
        <div className="MatchedPersonBackground1"></div>
        <div className="MatchedPersonProfile">
          <img src={vsPersonProfile1} alt='vsPersonProfile1' />
        </div>
        <div className="MatchedPersonNickName">
          {USER1_NICKNAME}
        </div>
        <div className="MatchedPersonIntro">
          {USER1_INTRO}
        </div>
      </div>

      <div className="MatchedPerson2">
        <div className="MatchedPersonBackground2"></div>
        <div className="MatchedPersonProfile">
          <img src={vsPersonProfile2} alt='vsPersonProfile2' />
        </div>
        <div className="MatchedPersonNickName">
          {USER2_NICKNAME}
        </div>
        <div className="MatchedPersonIntro">
          {USER2_INTRO}
        </div>
      </div>
    </div>
  );
};
